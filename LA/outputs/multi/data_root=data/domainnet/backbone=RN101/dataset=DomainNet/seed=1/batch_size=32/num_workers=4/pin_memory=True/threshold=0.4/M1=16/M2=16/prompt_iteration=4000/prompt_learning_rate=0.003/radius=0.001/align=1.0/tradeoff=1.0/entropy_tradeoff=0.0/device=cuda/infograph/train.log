Generating pseudo labels for infograph data
pseudo label correct rate is 0.41752974568147216
Data statistic {'clipart': 48833, 'painting': 75759, 'quickdraw': 172500, 'real': 175327, 'sketch': 70386}
=================================================================
Layer (type:depth-idx)                   Param #
=================================================================
PromptGenerator                          2,834,432
├─ParameterList: 1-1                     40,960
=================================================================
Total params: 2,875,392
Trainable params: 2,875,392
Non-trainable params: 0
=================================================================
PromptGenerator =================================================================
Layer (type:depth-idx)                   Param #
=================================================================
PromptGenerator                          2,834,432
├─ParameterList: 1-1                     40,960
=================================================================
Total params: 2,875,392
Trainable params: 2,875,392
Non-trainable params: 0
=================================================================
name: ctx_cls, shape torch.Size([345, 16, 512]), require grad: True
name: ctx_target, shape torch.Size([1, 16, 512]), require grad: True
name: ctx_source.0, shape torch.Size([1, 16, 512]), require grad: True
name: ctx_source.1, shape torch.Size([1, 16, 512]), require grad: True
name: ctx_source.2, shape torch.Size([1, 16, 512]), require grad: True
name: ctx_source.3, shape torch.Size([1, 16, 512]), require grad: True
name: ctx_source.4, shape torch.Size([1, 16, 512]), require grad: True
Best accuracy so far: 0.49810093261131166, step 500, accuracy 0.49810093261131166
Best accuracy so far: 0.5045314380264742, step 1000, accuracy 0.5045314380264742
Best accuracy so far: 0.5045314380264742, step 1500, accuracy 0.48411176293622143
Best accuracy so far: 0.5045314380264742, step 2000, accuracy 0.47442839951865223
Best accuracy so far: 0.5045314380264742, step 2500, accuracy 0.4780949157641396
Best accuracy so far: 0.5045314380264742, step 2510, accuracy 0.47956152226233456
Best accuracy so far: 0.5045314380264742, step 2520, accuracy 0.48070848375451264
Best accuracy so far: 0.5045314380264742, step 2530, accuracy 0.4787718110709988
Best accuracy so far: 0.5045314380264742, step 2540, accuracy 0.4740147412755716
Best accuracy so far: 0.5045314380264742, step 2550, accuracy 0.4723601083032491
Best accuracy so far: 0.5045314380264742, step 2560, accuracy 0.4725105294825511
Best accuracy so far: 0.5045314380264742, step 2570, accuracy 0.472830174488568
Best accuracy so far: 0.5045314380264742, step 2580, accuracy 0.47388312274368233
Best accuracy so far: 0.5045314380264742, step 2590, accuracy 0.4737703068592058
Best accuracy so far: 0.5045314380264742, step 2600, accuracy 0.47491726835138387
Best accuracy so far: 0.5045314380264742, step 2610, accuracy 0.4753873345367028
Best accuracy so far: 0.5045314380264742, step 2620, accuracy 0.4741839651022864
Best accuracy so far: 0.5045314380264742, step 2630, accuracy 0.4742779783393502
Best accuracy so far: 0.5045314380264742, step 2640, accuracy 0.47461642599277976
Best accuracy so far: 0.5045314380264742, step 2650, accuracy 0.478452166064982
Best accuracy so far: 0.5045314380264742, step 2660, accuracy 0.47768125752105894
Best accuracy so far: 0.5045314380264742, step 2670, accuracy 0.4754625451263538
Best accuracy so far: 0.5045314380264742, step 2680, accuracy 0.47313101684717207
Best accuracy so far: 0.5045314380264742, step 2690, accuracy 0.4766283092659446
Best accuracy so far: 0.5045314380264742, step 2700, accuracy 0.4771923886883273
Best accuracy so far: 0.5045314380264742, step 2710, accuracy 0.47399593862815886
Best accuracy so far: 0.5045314380264742, step 2720, accuracy 0.475218110709988
Best accuracy so far: 0.5045314380264742, step 2730, accuracy 0.476139440433213
Best accuracy so far: 0.5045314380264742, step 2740, accuracy 0.4757257821901324
Best accuracy so far: 0.5045314380264742, step 2750, accuracy 0.4750488868832732
Best accuracy so far: 0.5045314380264742, step 2760, accuracy 0.4733002406738869
Best accuracy so far: 0.5045314380264742, step 2770, accuracy 0.474522412755716
Best accuracy so far: 0.5045314380264742, step 2780, accuracy 0.4787718110709988
Best accuracy so far: 0.5045314380264742, step 2790, accuracy 0.47984356197352585
Best accuracy so far: 0.5045314380264742, step 2800, accuracy 0.4754625451263538
Best accuracy so far: 0.5045314380264742, step 2810, accuracy 0.47442839951865223
Best accuracy so far: 0.5045314380264742, step 2820, accuracy 0.4746540312876053
Best accuracy so far: 0.5045314380264742, step 2830, accuracy 0.47619584837545126
Best accuracy so far: 0.5045314380264742, step 2840, accuracy 0.47670351985559567
Best accuracy so far: 0.5045314380264742, step 2850, accuracy 0.4787718110709988
Best accuracy so far: 0.5045314380264742, step 2860, accuracy 0.47709837545126355
Best accuracy so far: 0.5045314380264742, step 2870, accuracy 0.4778692839951865
Best accuracy so far: 0.5045314380264742, step 2880, accuracy 0.47858378459687123
Best accuracy so far: 0.5045314380264742, step 2890, accuracy 0.47783167870036103
Best accuracy so far: 0.5045314380264742, step 2900, accuracy 0.47848977135980747
Best accuracy so far: 0.5045314380264742, step 2910, accuracy 0.47820773164861613
Best accuracy so far: 0.5045314380264742, step 2920, accuracy 0.47675992779783394
Best accuracy so far: 0.5045314380264742, step 2930, accuracy 0.47501128158844763
Best accuracy so far: 0.5045314380264742, step 2940, accuracy 0.4762710589651023
Best accuracy so far: 0.5045314380264742, step 2950, accuracy 0.47403354392298436
Best accuracy so far: 0.5045314380264742, step 2960, accuracy 0.47512409747292417
Best accuracy so far: 0.5045314380264742, step 2970, accuracy 0.473751504211793
Best accuracy so far: 0.5045314380264742, step 2980, accuracy 0.47209687123947053
Best accuracy so far: 0.5045314380264742, step 2990, accuracy 0.47173962093862815
Best accuracy so far: 0.5045314380264742, step 3000, accuracy 0.4748420577617328
Best accuracy so far: 0.5045314380264742, step 3010, accuracy 0.47623345367027675
Best accuracy so far: 0.5045314380264742, step 3020, accuracy 0.4771171780986763
Best accuracy so far: 0.5045314380264742, step 3030, accuracy 0.47801970517448855
Best accuracy so far: 0.5045314380264742, step 3040, accuracy 0.47888462695547535
Best accuracy so far: 0.5045314380264742, step 3050, accuracy 0.47657190132370636
Best accuracy so far: 0.5045314380264742, step 3060, accuracy 0.47456001805054154
Best accuracy so far: 0.5045314380264742, step 3070, accuracy 0.47190884476534295
Best accuracy so far: 0.5045314380264742, step 3080, accuracy 0.4723225030084236
Best accuracy so far: 0.5045314380264742, step 3090, accuracy 0.47294299037304455
Best accuracy so far: 0.5045314380264742, step 3100, accuracy 0.4761206377858002
Best accuracy so far: 0.5045314380264742, step 3110, accuracy 0.4764590854392298
Best accuracy so far: 0.5045314380264742, step 3120, accuracy 0.474522412755716
Best accuracy so far: 0.5045314380264742, step 3130, accuracy 0.472134476534296
Best accuracy so far: 0.5045314380264742, step 3140, accuracy 0.47848977135980747
Best accuracy so far: 0.5045314380264742, step 3150, accuracy 0.4812725631768953
Best accuracy so far: 0.5045314380264742, step 3160, accuracy 0.48146058965102284
Best accuracy so far: 0.5045314380264742, step 3170, accuracy 0.4804076413959085
Best accuracy so far: 0.5045314380264742, step 3180, accuracy 0.47879061371841153
Best accuracy so far: 0.5045314380264742, step 3190, accuracy 0.4780761131167268
Best accuracy so far: 0.5045314380264742, step 3200, accuracy 0.47632746690734057
Best accuracy so far: 0.5045314380264742, step 3210, accuracy 0.4727361612515042
Best accuracy so far: 0.5045314380264742, step 3220, accuracy 0.47439079422382674
Best accuracy so far: 0.5045314380264742, step 3230, accuracy 0.47583859807460893
Best accuracy so far: 0.5045314380264742, step 3240, accuracy 0.47775646811071
Best accuracy so far: 0.5045314380264742, step 3250, accuracy 0.48016320697954273
Best accuracy so far: 0.5045314380264742, step 3260, accuracy 0.4788094163658243
Best accuracy so far: 0.5045314380264742, step 3270, accuracy 0.4766659145607702
Best accuracy so far: 0.5045314380264742, step 3280, accuracy 0.47296179302045727
Best accuracy so far: 0.5045314380264742, step 3290, accuracy 0.4687123947051745
Best accuracy so far: 0.5045314380264742, step 3300, accuracy 0.46796028880866425
Best accuracy so far: 0.5045314380264742, step 3310, accuracy 0.47313101684717207
Best accuracy so far: 0.5045314380264742, step 3320, accuracy 0.4757257821901324
Best accuracy so far: 0.5045314380264742, step 3330, accuracy 0.47691034897713597
Best accuracy so far: 0.5045314380264742, step 3340, accuracy 0.4734130565583634
Best accuracy so far: 0.5045314380264742, step 3350, accuracy 0.4715515944645006
Best accuracy so far: 0.5045314380264742, step 3360, accuracy 0.4737703068592058
Best accuracy so far: 0.5045314380264742, step 3370, accuracy 0.47437199157641396
Best accuracy so far: 0.5045314380264742, step 3380, accuracy 0.4719652527075812
Best accuracy so far: 0.5045314380264742, step 3390, accuracy 0.46918246089049337
Best accuracy so far: 0.5045314380264742, step 3400, accuracy 0.47064906738868834
Best accuracy so far: 0.5045314380264742, step 3410, accuracy 0.4714387785800241
Best accuracy so far: 0.5045314380264742, step 3420, accuracy 0.4701413959085439
Best accuracy so far: 0.5045314380264742, step 3430, accuracy 0.46920126353790614
Best accuracy so far: 0.5045314380264742, step 3440, accuracy 0.4692576714801444
Best accuracy so far: 0.5045314380264742, step 3450, accuracy 0.47042343561973526
Best accuracy so far: 0.5045314380264742, step 3460, accuracy 0.47025421179302046
Best accuracy so far: 0.5045314380264742, step 3470, accuracy 0.4688816185318893
Best accuracy so far: 0.5045314380264742, step 3480, accuracy 0.470517448856799
Best accuracy so far: 0.5045314380264742, step 3490, accuracy 0.4723413056558363
Best accuracy so far: 0.5045314380264742, step 3500, accuracy 0.4707806859205776
Best accuracy so far: 0.5045314380264742, step 3510, accuracy 0.47068667268351383
Best accuracy so far: 0.5045314380264742, step 3520, accuracy 0.469520908543923
Best accuracy so far: 0.5045314380264742, step 3530, accuracy 0.46829873646209386
Best accuracy so far: 0.5045314380264742, step 3540, accuracy 0.4716080024067389
Best accuracy so far: 0.5045314380264742, step 3550, accuracy 0.4739395306859206
Best accuracy so far: 0.5045314380264742, step 3560, accuracy 0.47581979542719616
Best accuracy so far: 0.5045314380264742, step 3570, accuracy 0.4725669374247894
Best accuracy so far: 0.5045314380264742, step 3580, accuracy 0.46974654031287605
Best accuracy so far: 0.5045314380264742, step 3590, accuracy 0.4732062274368231
Best accuracy so far: 0.5045314380264742, step 3600, accuracy 0.47621465102286403
Best accuracy so far: 0.5045314380264742, step 3610, accuracy 0.47636507220216606
Best accuracy so far: 0.5045314380264742, step 3620, accuracy 0.475218110709988
Best accuracy so far: 0.5045314380264742, step 3630, accuracy 0.4733002406738869
Best accuracy so far: 0.5045314380264742, step 3640, accuracy 0.4742779783393502
Best accuracy so far: 0.5045314380264742, step 3650, accuracy 0.47420276774969916
Best accuracy so far: 0.5045314380264742, step 3660, accuracy 0.47311221419975935
Best accuracy so far: 0.5045314380264742, step 3670, accuracy 0.47189004211793023
Best accuracy so far: 0.5045314380264742, step 3680, accuracy 0.47578219013237066
Best accuracy so far: 0.5045314380264742, step 3690, accuracy 0.47912906137184114
Best accuracy so far: 0.5045314380264742, step 3700, accuracy 0.4784333634175692
Best accuracy so far: 0.5045314380264742, step 3710, accuracy 0.47976835138387486
Best accuracy so far: 0.5045314380264742, step 3720, accuracy 0.48016320697954273
Best accuracy so far: 0.5045314380264742, step 3730, accuracy 0.4764590854392298
Best accuracy so far: 0.5045314380264742, step 3740, accuracy 0.47512409747292417
Best accuracy so far: 0.5045314380264742, step 3750, accuracy 0.4723977135980746
Best accuracy so far: 0.5045314380264742, step 3760, accuracy 0.47166441034897716
Best accuracy so far: 0.5045314380264742, step 3770, accuracy 0.4727361612515042
Best accuracy so far: 0.5045314380264742, step 3780, accuracy 0.47224729241877256
Best accuracy so far: 0.5045314380264742, step 3790, accuracy 0.47117554151624547
Best accuracy so far: 0.5045314380264742, step 3800, accuracy 0.47369509626955475
Best accuracy so far: 0.5045314380264742, step 3810, accuracy 0.47640267749699156
Best accuracy so far: 0.5045314380264742, step 3820, accuracy 0.4791478640192539
Best accuracy so far: 0.5045314380264742, step 3830, accuracy 0.4771735860409146
Best accuracy so far: 0.5045314380264742, step 3840, accuracy 0.47548134777376655
Best accuracy so far: 0.5045314380264742, step 3850, accuracy 0.47531212394705175
Best accuracy so far: 0.5045314380264742, step 3860, accuracy 0.4768727436823105
Best accuracy so far: 0.5045314380264742, step 3870, accuracy 0.4775684416365824
Best accuracy so far: 0.5045314380264742, step 3880, accuracy 0.4793358904933815
Best accuracy so far: 0.5045314380264742, step 3890, accuracy 0.4777000601684717
Best accuracy so far: 0.5045314380264742, step 3900, accuracy 0.4749924789410349
Best accuracy so far: 0.5045314380264742, step 3910, accuracy 0.47439079422382674
Best accuracy so far: 0.5045314380264742, step 3920, accuracy 0.4761018351383875
Best accuracy so far: 0.5045314380264742, step 3930, accuracy 0.47794449458483756
Best accuracy so far: 0.5045314380264742, step 3940, accuracy 0.47632746690734057
Best accuracy so far: 0.5045314380264742, step 3950, accuracy 0.47457882069795426
Best accuracy so far: 0.5045314380264742, step 3960, accuracy 0.47399593862815886
Best accuracy so far: 0.5045314380264742, step 3970, accuracy 0.47527451865222625
Best accuracy so far: 0.5045314380264742, step 3980, accuracy 0.4768163357400722
Best accuracy so far: 0.5045314380264742, step 3990, accuracy 0.4763086642599278
Best accuracy so far: 0.5045314380264742, step 4000, accuracy 0.47811371841155237
Best accuracy for each domain: [0.6789605176933159, 0.5045314380264742] Average: 0.591745977859895
Number of conflicts: 0 Total steps: 4000 Conflict rate: 0.0
Average cosine similarity between gradients: nan
Cosine similarity between gradients: []
